---
# tasks file for deploy-nginx-vault

- name: nginx
  apt:
    name: nginx
    state: '{{ nginx_state }}'
    update_cache: true
- name: start nginx
  service:
    name: nginx
    state: started
    enabled: true
- name: Allow all access to  port 80
  ufw:
    rule: allow
    port: '80'
    proto: tcp
- name: Remove defaults
  file:
    state: absent
    path: "{{ site_enabled_path }}/default"
  notify: Reload Nginx
- name: Performing Tasks for first host
  include_tasks: abrams1.yaml
  when: ansible_facts['hostname'] == 'abrams1'
- name: Performing Tasks for second host
  include_tasks: abrams2.yaml
  when: ansible_facts['hostname'] == 'abrams2'
